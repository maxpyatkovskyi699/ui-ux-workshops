# ПЗ-14 Оптимізація зображень

## **Мета роботи**

1. Ознайомити студентів із методами стиснення зображень та їхнім впливом на якість.
2. Навчити визначати оптимальний баланс між якістю та розміром файлу.
3. Ознайомити студентів із різними типами стиснення: без втрат (lossless) та з втратами (lossy).
4. Дослідити вплив зміни розміру на якість зображення та вагу файлу.
5. Навчитися адаптувати зображення для різних цільових застосувань:
   - Веб (оптимізація для швидкого завантаження).
   - Мобільні пристрої (зменшені розміри, ефективне стиснення).
   - Retina-дисплеї (2x, 3x версії для збереження якості).
6. Закріпити навички документування та аналізу результатів у Markdown-форматі у GitHub-репозиторії.

---

## **Теоретична частина**

### **1. Що таке Squoosh і як він працює?**

Squoosh — це веб-додаток для стиснення та оптимізації зображень, який дозволяє змінювати формат, якість та розмір файлу прямо у браузері.  
Він працює локально, не вимагаючи завантаження файлу на сервер, і дає змогу порівняти оригінал та результат стиснення у режимі реального часу.

---

### **2. Формати зображень та типи стиснення**

**Стиснення без втрати якості (lossless):**

- **PNG**  
  Формат без втрати якості. Підтримує прозорість та індексацію кольорів. Застосовується для іконок, скріншотів, графіки з текстом. Файл може бути великим, але зберігає всі деталі.

- **WebP (lossless)**  
  Сучасний формат без втрати якості. Забезпечує меншу вагу файлу порівняно з PNG при збереженні деталей та прозорості. Добре підходить для веб-графіки та інтерфейсів.

**Стиснення з втратою якості (lossy):**

- **MozJPEG**  
  Формат JPEG із покращеним алгоритмом стиснення. Зменшує вагу файлу при мінімальній втраті якості. Ідеально для фотографій у вебі.

- **WebP (lossy)**  
  Сучасний формат із стисненням із втратою якості. Менша вага файлу порівняно з JPEG при схожому візуальному результаті. Підтримує анімацію та прозорість (через альфа-канал).

- **AVIF**  
  Новий формат стиснення з втратою якості на основі кодека AV1. Забезпечує значне зменшення розміру файлу при високій якості зображення. Підходить для сучасних веб-додатків та мобільних пристроїв.

- Стиснення без втрати якості дозволяє зберегти усі деталі оригіналу, але вага файлу залишається великою.
- Стиснення з втратою якості зменшує розмір файлу, але частина деталей може бути втрачена.

---

### **3. Зміна розміру та її вплив на якість і вагу файлу**

- Зменшення розміру зображення зменшує вагу файлу, але може знизити чіткість та деталізацію.
- Збільшення розміру зображення може зробити його розмитим, якщо джерело має низьку роздільну здатність.

---

### **4. Оптимізація зображень для Retina-дисплеїв**

- Використання зображень у збільшеному розмірі (2x, 3x) дозволяє зберегти чіткість на дисплеях з високою щільністю пікселів.
- Використання адаптивних зображень через атрибут `srcset` у HTML дозволяє браузеру підбирати оптимальний розмір для конкретного пристрою, що зменшує вагу сторінки та підвищує швидкість завантаження.

---

## **Практичне завдання**

### 1. Аналіз вихідних файлів

1. Виберіть 3 типи зображень (фотографія, скріншот, графічне зображення з текстом).

- Фотографія

  ***

  ![Photo](images/nature.jpg)

  ***

- Скріншот

  ***

  ![Photo](images/screenshot.png)

  ***

- Графічне зображення з текстом
  ***
  ![Photo](images/youtube.png)
  ***

2. Зафіксуйте їхній початковий розмір, формат (JPEG, PNG тощо) та вагу файлу.

- Фотографія

  - Розмір: 2000х1334
  - Формат: JPG
  - Вага файлу: 586 КБ

  ***

  ![Photo](images/nature-info.png)

  ***

- Скріншот

  - Розмір: 1599х851
  - Формат: JPG
  - Вага файлу: 146 КБ

  ***

  ![Photo](images/screenshot-info.png)

  ***

- Графічне зображення з текстом

  - Розмір: 311х162
  - Формат: JPG
  - Вага файлу: 2.54 КБ

  ***

  ![Photo](images/youtube-info.png)

  ***

### 2. Стиснення без втрати якості (lossless)

3. Завантажте кожне зображення в Squoosh.
4. Використайте формати PNG (lossless) та WebP (lossless).
5. Зафіксуйте зміни у вазі файлу після кожного перетворення.
6. Переконайтеся, що якість зображення залишилася незмінною.

- Фотографія у форматі PNG: 586 КБ → 4.38 МБ (+630%)

  ![Photo](images/nature-png.png)

---

- Фотографія у форматі WEBP: 586 КБ → 2.68 МБ (+347%)

  ![Photo](images/nature-webp.png)

---

- Скріншот у форматі PNG: 146 КБ → 198 КБ (+32%)

  ![Photo](images/screenshot-png.png)

---

- Скріншот у форматі WEBP: 146 КБ → 47.2 КБ (-69%)

  ![Photo](images/screenshot-webp.png)

---

- Графічне зображення з текстом у форматі PNG: 2.54 КБ → 7.94 КБ (+205%)

  ![Photo](images/youtube-png.png)

---

- Графічне зображення з текстом у форматі WEBP: 2.54 КБ → 2.09 КБ (-20%)

  ![Photo](images/youtube-webp.png)

---

- Оскільки алгоритм lossless зберігає всі пікселі без змін, якість залишилася ідентичною вихідному файлу.

---

### 3. Стиснення з втратою якості (lossy)

7. Використайте формати MozJPEG, WebP (lossy) та AVIF.
8. Виконайте стиснення на рівнях якості 100%, 75% та 50%.
9. Зафіксуйте зміни розміру файлу.

- Фотографія

  - MozJPEG

    - 100%: 2.00 МБ (+232%)

      ![Photo](images/nature-mozjpeg-100.png)

      ***

    - 75%: 434 КБ (-28%)

      ![Photo](images/nature-mozjpeg-75.png)

      ***

    - 50%: 258 КБ (-57%)

      ![Photo](images/nature-mozjpeg-50.png)

      ***

  - WebP (lossy)

    - 100%: 1.18 МБ (+97%)

      ![Photo](images/nature-webp-lossy-100.png)

      ***

    - 75%: 416 КБ (-31%)

      ![Photo](images/nature-webp-lossy-75.png)

      ***

    - 50%: 315 КБ (-48%)

      ![Photo](images/nature-webp-lossy-50.png)

      ***

  - AVIF

    - 100%: 1.02 МБ (+70%)

      ![Photo](images/nature-avif-lossy-100.png)

      ***

    - 75%: 495 КБ (-18%)

      ![Photo](images/nature-avif-lossy-75.png)

      ***

    - 50%: 320 КБ (-47%)

      ![Photo](images/nature-avif-lossy-50.png)

      ***

- Скріншот

  - MozJPEG

    - 100%: 529 КБ (+253%)

      ![Photo](images/screenshot-mozjpeg-100.png)

      ***

    - 75%: 99.5 КБ (-34%)

      ![Photo](images/screenshot-mozjpeg-75.png)

      ***

    - 50%: 67.5 КБ (-55%)

      ![Photo](images/screenshot-mozjpeg-50.png)

      ***

  - WebP (lossy)

    - 100%: 173 КБ (+16%)

      ![Photo](images/screenshot-webp-lossy-100.png)

      ***

    - 75%: 79.8 КБ (-47%)

      ![Photo](images/screenshot-webp-lossy-75.png)

      ***

    - 50%: 66.8 КБ (-55%)

      ![Photo](images/screenshot-webp-lossy-50.png)

      ***

  - AVIF

    - 100%: 116 КБ (+23%)

      ![Photo](images/screenshot-avif-lossy-100.png)

      ***

    - 75%: 62.5 КБ (-58%)

      ![Photo](images/screenshot-avif-lossy-75.png)

      ***

    - 50%: 40.7 КБ (-73%)

      ![Photo](images/screenshot-avif-lossy-50.png)

      ***

- Графічне зображення з текстом

  - MozJPEG

    - 100%: 10.3 КБ (+306%)

      ![Photo](images/youtube-mozjpeg-100.png)

      ***

    - 75%: 3.17 КБ (+22%)

      ![Photo](images/youtube-mozjpeg-75.png)

      ***

    - 50%: 2.53 КБ (-3%)

      ![Photo](images/youtube-mozjpeg-50.png)

      ***

  - WebP (lossy)

    - 100%: 4.31 КБ (+65%)

      ![Photo](images/youtube-webp-lossy-100.png)

      ***

    - 75%: 2.01 КБ (-23%)

      ![Photo](images/youtube-webp-lossy-75.png)

      ***

    - 50%: 1.68 КБ (-35%)

      ![Photo](images/youtube-webp-lossy-50.png)

      ***

  - AVIF

    - 100%: 4.02 КБ (+54%)

      ![Photo](images/youtube-avif-lossy-100.png)

      ***

    - 75%: 2.27 КБ (-13%)

      ![Photo](images/youtube-avif-lossy-75.png)

      ***

    - 50%: 1.63 КБ (-37%)

      ![Photo](images/youtube-avif-lossy-50.png)

      ***

| Тип зображення      | Формат       | Якість | Вага файлу | Зміна |
| ------------------- | ------------ | ------ | ---------- | ----- |
| **Фотографія**      | MozJPEG      | 100%   | 2.00 МБ    | +232% |
|                     |              | 75%    | 434 КБ     | -28%  |
|                     |              | 50%    | 258 КБ     | -57%  |
|                     | WebP (lossy) | 100%   | 1.18 МБ    | +97%  |
|                     |              | 75%    | 416 КБ     | -31%  |
|                     |              | 50%    | 315 КБ     | -48%  |
|                     | AVIF         | 100%   | 1.02 МБ    | +70%  |
|                     |              | 75%    | 495 КБ     | -18%  |
|                     |              | 50%    | 320 КБ     | -47%  |
| **Скріншот**        | MozJPEG      | 100%   | 529 КБ     | +253% |
|                     |              | 75%    | 99.5 КБ    | -34%  |
|                     |              | 50%    | 67.5 КБ    | -55%  |
|                     | WebP (lossy) | 100%   | 173 КБ     | +16%  |
|                     |              | 75%    | 79.8 КБ    | -47%  |
|                     |              | 50%    | 66.8 КБ    | -55%  |
|                     | AVIF         | 100%   | 116 КБ     | +23%  |
|                     |              | 75%    | 62.5 КБ    | -58%  |
|                     |              | 50%    | 40.7 КБ    | -73%  |
| **Графіка + текст** | MozJPEG      | 100%   | 10.3 КБ    | +306% |
|                     |              | 75%    | 3.17 КБ    | +22%  |
|                     |              | 50%    | 2.53 КБ    | -3%   |
|                     | WebP (lossy) | 100%   | 4.31 КБ    | +65%  |
|                     |              | 75%    | 2.01 КБ    | -23%  |
|                     |              | 50%    | 1.68 КБ    | -35%  |
|                     | AVIF         | 100%   | 4.02 КБ    | +54%  |
|                     |              | 75%    | 2.27 КБ    | -13%  |
|                     |              | 50%    | 1.63 КБ    | -37%  |

---

10. Визначте мінімальний рівень якості, при якому зображення залишається прийнятним.

| Тип зображення                | MozJPEG | WebP | AVIF |
| ----------------------------- | ------- | ---- | ---- |
| Фотографія                    | 70%     | 60%  | 40%  |
| Скріншот                      | 85%     | 75%  | 35%  |
| Графічне зображення з текстом | 80%     | 40%  | 55%  |

---

### 4. Оптимізація розміру відповідно до цільового використання

11. Зменшіть розмір зображень відповідно до їхнього застосування:

    - Для вебу: максимальна ширина 1200 px.

      - Фотографія: 158 КБ (-74%)

        ![Photo](images/nature-1200.png)

        ***

      - Скріншот: 64.1 КБ (-57%)

        ![Photo](images/screenshot-1200.png)

        ***

      - Графічне зображення з текстом: 16.2 КБ (+520%)

        ![Photo](images/youtube-1200.png)

        ***

    - Для мобільних пристроїв: максимальна ширина 600 px.

      - Фотографія: 38.6 КБ (-94%)

        ![Photo](images/nature-600.png)

        ***

      - Скріншот: 19.4 КБ (-87%)

        ![Photo](images/screenshot-600.png)

        ***

      - Графічне зображення з текстом: 6.49 КБ (+149%)

        ![Photo](images/youtube-600.png)

        ***

    - Для Retina-дисплеїв: створіть 2x та 3x версію зображення.

      - Фотографія (2x): 3.71 МБ (+518%)

        ![Photo](images/nature-2400.png)

        ***

      - Скріншот (2x): 172 КБ (+15%)

        ![Photo](images/screenshot-2400.png)

        ***

      - Графічне зображення з текстом (2x): 43.4 КБ (+1563%)

        ![Photo](images/youtube-2400.png)

        ***

      - Фотографія (3x): 6.85 МБ (+1041%)

        ![Photo](images/nature-3600.png)

        ***

      - Скріншот (3x): 300 КБ (+100%)

        ![Photo](images/screenshot-3600.png)

        ***

      - Графічне зображення з текстом (3x): 78.6 КБ (+2914%)

        ![Photo](images/youtube-3600.png)

---

12. Зафіксуйте зміни у вазі файлу після кожного етапу.

| Тип зображення      | Призначення    | Ширина  | Вага файлу | Зміна  |
| ------------------- | -------------- | ------- | ---------- | ------ |
| **Фотографія**      | Web (1200px)   | 1200 px | 158 КБ     | -74%   |
|                     | Mobile (600px) | 600 px  | 38.6 КБ    | -94%   |
|                     | Retina 2x      | 2400 px | 3.71 МБ    | +518%  |
|                     | Retina 3x      | 3600 px | 6.85 МБ    | +1041% |
| **Скріншот**        | Web (1200px)   | 1200 px | 64.1 КБ    | -57%   |
|                     | Mobile (600px) | 600 px  | 19.4 КБ    | -87%   |
|                     | Retina 2x      | 2400 px | 172 КБ     | +15%   |
|                     | Retina 3x      | 3600 px | 300 КБ     | +100%  |
| **Графіка + текст** | Web (1200px)   | 1200 px | 16.2 КБ    | +520%  |
|                     | Mobile (600px) | 600 px  | 6.49 КБ    | +149%  |
|                     | Retina 2x      | 2400 px | 43.4 КБ    | +1563% |
|                     | Retina 3x      | 3600 px | 78.6 КБ    | +2914% |

---

### 5. Візуальний аналіз та висновки

13. Порівняйте вихідні та оптимізовані зображення.

- **Фотографія**

  - Сильно стискається у форматах MozJPEG, WebP та AVIF на рівні 50–75% якості.
  - Артефакти зʼявляються лише при 50% у MozJPEG, тоді як WebP і AVIF дають кращий баланс між якістю та вагою.
  - Зменшення роздільної здатності (1200 px і 600 px) суттєво знижує вагу без великої втрати якості.

- **Скріншот**

  - Скриншоти містять багато однотонних областей, тому стискання ефективніше.
  - AVIF і WebP дають найкращий результат: сильне зменшення ваги без артефактів.
  - MozJPEG на 50% починає «змазувати» текст.

- **Графічне зображення з текстом**

  - Найгірше стискається у JPEG (сильні артефакти навіть при високій якості).
  - WebP та AVIF зберігають чіткість краще, але при 50% можливі легкі "блоки".
  - Зменшення розміру (600 px, 1200 px) сильно збільшує вагу PNG-зображення, тому для графіки ресайз небажаний.

14. Визначте, які формати та параметри оптимізації найкраще підходять для кожного типу зображень.

---

#### **1. Фотографія**

- **Найкращий формат:** WebP (lossy) або AVIF
- **Оптимальна якість:** 60–75%
- **Причина:** мінімальні артефакти та найменший обсяг файлу.

#### **2. Скріншот**

- **Найкращий формат:** AVIF (lossy)
- **Оптимальна якість:** 50–75%
- **Причина:** зберігає чіткість тексту і дає максимальне стиснення.

#### **3. Графічне зображення з текстом**

- **Найкращий формат:** WebP (lossless) або PNG
- **Якість:** не застосовується
- **Причина:** будь-яке lossy-стиснення спотворює текст і контури.

---

## **Висновки**

1. **Формати зображень:**

   - Для фотографій найкраще підходять формати WebP (lossy) або AVI\*, оскільки вони забезпечують оптимальне співвідношення між якістю та вагою файлу.
   - Для скріншотів найефективніший формат — AVIF, що зберігає чіткість тексту та деталей при сильному стисненні.
   - Для графіки з текстом та логотипів найкраще використовувати WebP (lossless) або PNG, щоб уникнути спотворення контурів і тексту.

2. **Вплив зміни розміру на оптимізацію:**

   - Зменшення фізичного розміру зображень (наприклад, 1200 px або 600 px) суттєво знижує вагу файлу без значної втрати якості.
   - Для фотографій і скріншотів це ефективний спосіб швидкого зменшення розміру файлу.
   - Для графіки з текстом варто зменшувати розмір обережно, щоб не втратити чіткість деталей.

3. **Адаптація для Retina-дисплеїв:**

   - Для високої щільності пікселів створюють 2x або 3x версії зображень.
   - Retina-версії забезпечують чіткість на екранах з високою роздільною здатністю, але значно збільшують вагу файлу.
   - Рекомендується використовувати Retina-зображення лише для ключових елементів інтерфейсу, а для інших — адаптувати під стандартні розміри.
